#!/bin/bash

# This script provides an overview of the AI Workflow TMUX system

cat << EOF

=== ðŸ³ DOCKER INTEGRATION ===
â€¢ Status: Available - Use './setup-workflow.sh --docker' to enable
â€¢ Benefits: Isolated execution, consistent Ubuntu environment
â€¢ Fallback: Native mode active (commands run on host)

=== AI-WORKFLOW TMUX SYSTEM ===

ENVIRONMENT: ðŸ–¥ï¸  Native (Darwin)
WORKSPACE: /Volumes/ryan-home/ryan-homedir/devel/serena

STATUS: ai-workflow session NOT FOUND
RUN: ./setup-workflow.sh to create session

=== ðŸ§  SERENA INTEGRATION ===
â€¢ Memory Hub: Use 'serena' project for persistent context across sessions
â€¢ Key Memories: ai-workflow-system-overview, ai-token-optimization-research
â€¢ Access Pattern: Serena:activate_project('serena') â†’ Serena:read_memory('memory-name')
â€¢ Documentation: Serena:write_memory() to save important discoveries/context
â€¢ Shell Access: Serena:execute_shell_command() for tmux operations

=== ðŸ“ FILESYSTEM TOOLS INTEGRATION ===
â€¢ File Access: filesystem:read_file('/full/path/to/file') for ANY directory
â€¢ Safe Inspection: ALWAYS read before modifying files
â€¢ File Creation: filesystem:write_file('/path', 'content') with explicit content
â€¢ Directory Ops: filesystem:list_directory(), filesystem:search_files()
â€¢ Multi-file: filesystem:read_multiple_files(['path1', 'path2'])
â€¢ Safety: Time Machine backups provide recovery safety net
â€¢ Coverage: Full access to ~/devel, ~/ted, and any other directories

=== ðŸ¤– AI TOKEN OPTIMIZATION (Research Complete) ===
â€¢ Two-Tier Architecture: Claude (strategy) + phi3/Ollama (routine tasks)
â€¢ Handoff Pattern: Natural language â†’ phi3 translation â†’ tmux â†’ phi3 cleanup â†’ Claude
â€¢ Token Savings: Local AI handles parsing/translation, Claude focuses on reasoning
â€¢ Implementation: phi3-simulator.py demonstrates the pattern
â€¢ Test Suite: Comprehensive validation in tests/ directory
â€¢ Benefits: Speed, cost efficiency, reliability, scalability

=== âš ï¸  CRITICAL SAFETY RULES âš ï¸  ===
1. NEVER use heredoc syntax (cat << EOF) - ALWAYS use base64 encoding
2. If pane is stuck, DO NOT run recovery commands IN that pane
3. Run recovery commands from OUTSIDE tmux or in a different pane
4. Always add newline after EOF markers to avoid confusion
5. When in doubt, use base64: echo 'content' | base64 | base64 -d > file
6. Use filesystem tools CAREFULLY - inspect before modifying
7. Store important context in Serena memories for persistence

=== OPERATIONAL COMMAND PATTERNS ===
â€¢ Native tmux targets: ai-workflow:0.0 (left), ai-workflow:0.1 (top), ai-workflow:0.2 (bottom)
â€¢ Native command: tmux send-keys -t ai-workflow:0.[0|1|2] '[command]' Enter
â€¢ Native tmux capture: tmux capture-pane -t ai-workflow:0.[0|1|2] -p

=== ðŸ³ DOCKER TMUX COMMAND PATTERNS ===
â€¢ Docker Container Name: ai-workflow-dev
â€¢ Docker Tmux Session Name: ai-workflow
â€¢ Send command to left pane: 
  docker exec ai-workflow-dev tmux send-keys -t ai-workflow:0.0 'your command' Enter
â€¢ Send command to top pane: 
  docker exec ai-workflow-dev tmux send-keys -t ai-workflow:0.1 'your command' Enter
â€¢ Send command to bottom pane: 
  docker exec ai-workflow-dev tmux send-keys -t ai-workflow:0.2 'your command' Enter
â€¢ Capture Docker pane output: 
  docker exec ai-workflow-dev tmux capture-pane -t ai-workflow:0.[0|1|2] -p

=== TIMEOUT RECOMMENDATIONS ===
â€¢ Quick commands (ls, cd): 5-10 seconds
â€¢ Build commands: 60-300 seconds
â€¢ Test suites: 300-600 seconds
â€¢ Interactive programs: No timeout, monitor state instead

=== TROUBLESHOOTING STUCK SESSIONS ===
â€¢ Stuck in heredoc (> prompt): Send Ctrl+C, then clear
â€¢ Hanging command: Send Ctrl+C to interrupt
â€¢ Frozen terminal: Send Ctrl+L to refresh screen
â€¢ Wrong directory: Use 'cd' to navigate back
â€¢ Garbled output: Type 'reset' and press Enter
â€¢ Process won't die: Try Ctrl+C, then Ctrl+Z, then 'kill %1'
â€¢ Clear screen: Type 'clear' and press Enter
â€¢ Emergency reset: Type 'stty sane' and press Enter

=== ðŸŽ¯ INTEGRATED WORKFLOW PATTERN ===
1. Activate Serena: Serena:activate_project('serena')
2. Load context: Serena:read_memory('relevant-context')
3. Check tmux: ./tmux-hello (this script)
4. File operations: filesystem:read_file() â†’ inspect â†’ filesystem:write_file()
5. tmux commands: Serena:execute_shell_command() for tmux operations
6. Save context: Serena:write_memory() for important discoveries
7. AI collaboration: Natural language â†’ phi3 translation â†’ structured results

=== READY FOR AI COLLABORATION ===
EOF
